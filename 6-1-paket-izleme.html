<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>RPH - Paket İzleme Ekranı</title>
  <link href="style.css" rel="stylesheet" />
  <style>
    :root {
      --k-blue: #1976d2;
      --k-green: #2e7d32;
      --k-soft: #f5f6f7;
      --k-border: #e3e6ea;
      --row-alt: #f9fbfd;
      --text: #2c3e50;
    }

    body {
      margin: 0;
      background: var(--k-soft);
      font-family: "Segoe UI", Arial, Helvetica, sans-serif;
      color: var(--text);
    }

    .content-wrapper {
      padding: 20px;
    }

    .topbar {
      background: #fff;
      border: 1px solid var(--k-border);
      border-radius: 12px;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
      box-shadow: 0 2px 8px rgba(0, 0, 0, .05);
      margin-bottom: 20px;
    }

    .title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
      margin-right: auto;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--k-blue);
    }

    .iinput {
      min-width: 220px;
      padding: 8px 10px;
      border: 1px solid var(--k-border);
      border-radius: 8px;
      background: #fff;
      font-size: 14px;
    }

    .btn {
      border: 0;
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      transition: .2s;
    }

    .btn-green {
      background: #1ba94c;
      color: #fff;
    }

    .btn:hover {
      opacity: .92;
    }

    .table-card {
      background: #fff;
      border: 1px solid var(--k-border);
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, .05);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th,
    td {
      border-bottom: 1px solid var(--k-border);
      padding: 10px 8px;
      text-align: center;
      vertical-align: middle;
    }

    thead th {
      background: #f8f9fb;
      text-transform: uppercase;
      font-size: 12px;
      letter-spacing: .03em;
      font-weight: 700;
      color: #34495e;
    }

    tbody tr:nth-child(even) {
      background: var(--row-alt);
    }

    tbody tr:hover {
      background: #eef5ff;
    }

    .muted {
      color: #6c7580;
    }

    .cast-box {
      background: #f3f6fa;
      border-radius: 6px;
      padding: 6px 8px;
      display: inline-block;
      min-width: 110px;
      text-align: left;
    }

    .cast-item {
      border-bottom: 1px dashed #c8d4e2;
      padding: 3px 0;
      font-weight: 600;
      color: var(--k-blue);
      display: flex;
      justify-content: space-between;
    }

    .cast-item:last-child {
      border-bottom: none;
    }

    .cast-count {
      color: #2e7d32;
      font-weight: 700;
      margin-left: 8px;
    }
  </style>
</head>

<body>
  <!-- Sidebar -->
  <aside id="sidebar">
    <div id="sidebar-container" class="sidebar-container"></div>
    <script>
      fetch("sidebar.html")
        .then((res) => res.text())
        .then((data) => (document.getElementById("sidebar-container").innerHTML = data));
    </script>
  </aside>
  <div class="content-wrapper">
    <div class="topbar">
      <div class="title"><span class="dot"></span> RPH Paket & Etiket İzleme</div>
      <input class="iinput" id="searchCast" placeholder="Döküm numarası giriniz" />
      <input class="iinput" id="searchPkgId" placeholder="Paket ID giriniz" />
      <button class="btn btn-green" onclick="applyFilters()">Filtrele</button>
      <button class="btn" onclick="resetFilters()">Temizle</button>
    </div>

    <div class="table-card">
      <table>
        <thead>
          <tr>
            <th>Etiket ID</th>
            <th>Döküm No & Adet</th>
            <th>İş Emri No</th>
            <th>Paket ID</th>
            <th>Paket Tipi</th>
            <th>Paket İstif Türü</th>
            <th>Paketteki Toplam Profil Adedi</th>
            <th>Kayıt Tarihi</th>
            <th>Paket Ağırlığı (kg)</th>
            <th>Teyit Saati</th>
            <th>Çap (mm)</th>
            <th>Ürün Kalitesi</th>
            <th>Boy (m)</th>
            <th>Ekleyen Kullanıcı</th>
          </tr>
        </thead>
        <tbody id="pkgBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    const data = [
  // Paket 1 - 3 döküm (Ray)
  { etiketId: 'ETK-0001', cast: '2511234', adet: 4, order: '300003661', type: 'Profil', stack: '4x3',sumPaket:'12', date: '01.10.2025', weight: 1750, confirm: '07:45', pid: 'RPH0001', dia: 52.5, grade: 'S275JR_02', length: 52.5, user: 'RPH_USER' },
  { etiketId: 'ETK-0001', cast: '2511235', adet: 3, order: '300003661', type: 'Profil', stack: '4x3',sumPaket:'12', date: '01.10.2025', weight: 1780, confirm: '07:46', pid: 'RPH0001', dia: 52.5, grade: 'S235JR_00', length: 52.5, user: 'RPH_USER' },
  { etiketId: 'ETK-0001', cast: '2511236', adet: 5, order: '300003661', type: 'Profil', stack: '4x3',sumPaket:'12', date: '01.10.2025', weight: 1800, confirm: '07:47', pid: 'RPH0001', dia: 52.5, grade: 'S235JR_00', length: 52.5, user: 'RPH_USER' },

  // Paket 2 - 2 döküm (Profil)
  { etiketId: 'ETK-0002', cast: '2512230', adet: 8, order: '300003662', type: 'Profil', stack: '4x4',sumPaket:'16', date: '01.10.2025', weight: 1720, confirm: '09:15', pid: 'RPH0002', dia: 50, grade: 'S355JR_03', length: 50, user: 'RPH_USER' },
  { etiketId: 'ETK-0002', cast: '2512231', adet: 8, order: '300003662', type: 'Profil', stack: '4x4',sumPaket:'16', date: '01.10.2025', weight: 1740, confirm: '09:16', pid: 'RPH0002', dia: 50, grade: 'S355JR_03', length: 50, user: 'RPH_USER' },

  // Paket 3 - 1 döküm (Profil)
  { etiketId: 'ETK-0003', cast: '2513235', adet: 12, order: '300003663', type: 'Ray', stack: '3x4',sumPaket:'12', date: '01.10.2025', weight: 1850, confirm: '10:05', pid: 'RPH0003', dia: 9, grade: 'R260_02', length: 12, user: 'RPH_USER' },

  // Paket 4 - 3 döküm (Kare Kütük)
  { etiketId: 'ETK-0004', cast: '2514230', adet: 8, order: '300003664', type: 'Profil', stack: '5x3',sumPaket:'15', date: '02.10.2025', weight: 1950, confirm: '06:30', pid: 'RPH0004', dia: 130, grade: 'C45', length: 9, user: 'RPH_USER' },
  { etiketId: 'ETK-0004', cast: '2514231', adet: 1, order: '300003664', type: 'Profil', stack: '5x3',sumPaket:'15', date: '02.10.2025', weight: 1900, confirm: '06:32', pid: 'RPH0004', dia: 130, grade: 'C45', length: 9, user: 'RPH_USER' },
  { etiketId: 'ETK-0004', cast: '2514232', adet: 6, order: '300003664', type: 'Profil', stack: '5x3',sumPaket:'15', date: '02.10.2025', weight: 1925, confirm: '06:35', pid: 'RPH0004', dia: 130, grade: 'C45', length: 9, user: 'RPH_USER' },

  // Paket 5 - 2 döküm (Yuvarlak)
  { etiketId: 'ETK-0005', cast: '2515231', adet: 10, order: '300003665', type: 'Profil', stack: '6x4',sumPaket:'24', date: '02.10.2025', weight: 2100, confirm: '08:40', pid: 'RPH0005', dia: 60, grade: 'S355J2', length: 12, user: 'RPH_USER' },
  { etiketId: 'ETK-0005', cast: '2515232', adet: 14, order: '300003665', type: 'Profil', stack: '6x4',sumPaket:'24', date: '02.10.2025', weight: 2080, confirm: '08:41', pid: 'RPH0005', dia: 60, grade: 'S355J2', length: 12, user: 'RPH_USER' },

  // Paket 6 - 3 döküm (Ray)
  { etiketId: 'ETK-0006', cast: '2516235', adet: 4, order: '300003666', type: 'Profil', stack: '4x3',sumPaket:'12', date: '02.10.2025', weight: 1760, confirm: '09:00', pid: 'RPH0006', dia: 52.5, grade: 'R350HT', length: 52.5, user: 'RPH_USER' },
  { etiketId: 'ETK-0006', cast: '2516236', adet: 2, order: '300003666', type: 'Profil', stack: '4x3',sumPaket:'12', date: '02.10.2025', weight: 1785, confirm: '09:02', pid: 'RPH0006', dia: 52.5, grade: 'R350HT', length: 52.5, user: 'RPH_USER' },
  { etiketId: 'ETK-0006', cast: '2516237', adet: 6, order: '300003666', type: 'Profil', stack: '4x3',sumPaket:'12', date: '02.10.2025', weight: 1805, confirm: '09:04', pid: 'RPH0006', dia: 52.5, grade: 'R350HT', length: 52.5, user: 'RPH_USER' }
];


    const pkgBody = document.getElementById('pkgBody');

    function groupData(data) {
      const grouped = {};
      data.forEach(r => {
        if (!grouped[r.pid]) {
          grouped[r.pid] = {
            etiketId: r.etiketId,
            casts: [{ no: r.cast, adet: r.adet }],
            pid: r.pid,
            order: r.order,
            type: r.type,
            stack: r.stack,
            sumPaket:r.sumPaket,
            date: r.date,
            weight: r.weight,
            confirm: r.confirm,
            dia: r.dia,
            grade: r.grade,
            length: r.length,
            user: r.user
          };
        } else {
          grouped[r.pid].casts.push({ no: r.cast, adet: r.adet });
          grouped[r.pid].weight += r.weight;
        }
      });
      return Object.values(grouped);
    }

    function render(rows) {
      const grouped = groupData(rows);
      pkgBody.innerHTML = grouped.map(r => `
        <tr>
          <td>${r.etiketId}</td>
          <td>
            <div class="cast-box">
              ${r.casts.map(c => `
                <div class="cast-item">
                  <span>${c.no}</span>
                  <span class="cast-count">${c.adet} adet</span>
                </div>`).join('')}
            </div>
          </td>
          <td>${r.order}</td>
          <td>${r.pid}</td>
          <td>${r.type}</td>
          <td>${r.stack}</td>
          <td>${r.sumPaket}</td>
          <td>${r.date}</td>
          <td>${r.weight.toLocaleString('tr-TR')}</td>
          <td>${r.confirm}</td>
          <td>${r.dia}</td>
          <td>${r.grade}</td>
          <td>${r.length}</td>
          <td class="muted">${r.user}</td>
        </tr>
      `).join('');
    }

    function applyFilters() {
      const cast = document.getElementById('searchCast').value.trim();
      const pkg = document.getElementById('searchPkgId').value.trim();
      let filtered = data;
      if (cast) filtered = filtered.filter(r => r.cast.includes(cast));
      if (pkg) filtered = filtered.filter(r => r.pid.toLowerCase().includes(pkg.toLowerCase()));
      render(filtered);
    }

    function resetFilters() {
      document.getElementById('searchCast').value = '';
      document.getElementById('searchPkgId').value = '';
      render(data);
    }

    render(data);
  </script>
</body>
</html>
